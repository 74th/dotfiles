#!/usr/bin/python3
import os
import socket
import subprocess
import sys

current = socket.gethostname()

target = "./"
if len(sys.argv) == 2:
    target = sys.argv[1]
target = os.path.abspath(target)

if current == "ciel":
    host = "kukurushka"
    vm = "ciel"
    code_path = "/usr/local/bin/code"
elif current == "violet-gopher":
    host = "mac"
    vm = "violet"
    code_path = "/usr/local/bin/code"
elif current == "iroha":
    host = "mac"
    vm = "iroha"
    code_path = "/usr/local/bin/code"
else:
    host = ""
    vm = ""
    code_path = "code"

if host:
    cmd = ["ssh", host, code_path, "--remote", f"ssh-remote+{vm}", target]
else:
    cmd = [code_path, target]

print(" ".join(cmd))
subprocess.run(cmd, check=True, capture_output=True)
