#!/usr/bin/python3
# ghq を使ってディレクトリを選んで code コマンドを実行
import sys
import invoke
import platform
from socket import gethostname

c = invoke.Context()
g = c.run("ghq list | peco").stdout.strip()

if not g:
    sys.exit(1)

g = c.run(f"ghq list --full-path {g} | head -n1", hide=True).stdout.strip()
hostname = gethostname()
if hostname in ["violet-gopher"]:
    c.run(f"rcode {g}")
if hostname in ["violet-gopher"]:
    c.run(f"code-exploration {g}")
else:
    c.run(f"code {g}")
